"use strict";var showsubModule=angular.module("wizbif.showsub",["ui.bootstrap","wizbif.alert","wizbif.database"]);showsubModule.controller("ShowSubCtrl",["$scope","$uibModal","db","alert",function(e,s,t,u){e.show_times=t.getDefs("show_times"),e.requests=[];var o=function(){t.ShowSub.getSubRequests().then(function(s){e.requests=s})};e.addRequest=function(){s.open({templateUrl:"views/showsub_request.html",controller:"ShowSubRequestCtrl"}).result.then(o)},e.fill=function(e,s){confirm("Are you sure you want to sub this show on "+e.date+"? You will be held responsible if the show is missed.")&&t.ShowSub.fillSubRequest(e.sub_requestID).then(function(){e.filled_by=s.preferred_name,u.success("Sub request filled.")},function(e){u.error(e.data||e.statusText)})},e.remove=function(e,s){var o=e[s];confirm("Are you sure you want to remove your sub request? If you request another one less than 24 hours before your show, you will be held responsible for missing your show.")&&t.ShowSub.removeSubRequest(o.sub_requestID).then(function(){e.splice(s,1),u.success("Sub request removed.")},function(e){u.error(e.data||e.statusText)})},o()}]),showsubModule.controller("ShowSubRequestCtrl",["$scope","db","alert",function(e,s,t){e.today=Date.now(),e.days=s.getDefs("days"),e.show_times=s.getDefs("show_times"),e.user={},e.request={},e.isValidDay=function(s){var t=_.find(e.user.shows,{scheduleID:s.scheduleID});return(t||{}).dayID==s.date.getDay()},e.submit=function(u){s.ShowSub.submitSubRequest(u).then(function(){t.success("Sub request successfully added."),e.$close()},function(e){t.error(e.data||e.statusText)})},s.User.get().then(function(s){e.user=s})}]);