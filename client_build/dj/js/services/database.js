"use strict";var databaseModule=angular.module("wizbif.database",["ngResource"]);databaseModule.service("db",["$http","$q","$resource",function(t,e,r){var i={};i.Defs=r("/api/defs.php",{},{get:{method:"GET",isArray:!0,cache:!0}}),i.LogbookShow=r("/api/logbook/show.php"),i.LogbookTrack=r("/api/logbook/track.php"),i.Playlist=r("/api/playlist/playlist.php"),i.PlaylistTrack=r("/api/playlist/track.php"),i.Show=r("/api/schedule/show.php"),i.ShowSub=r("/api/showsub/request.php",{},{fill:{method:"POST"}});var n=null;this.getDefs=function(t){return i.Defs.get({table:t})},this.Alumni={},this.Alumni.getAlumni=function(){return t.get("/api/alumni/alumni.php").then(function(t){return t.data})},this.Carts={},this.Carts.getCarts=function(e){return t.get("/api/carts/carts.php",{params:{cart_typeID:e}}).then(function(t){return t.data})},this.Carts.getCart=function(e){return t.get("/api/carts/cart.php",{params:{cartID:e}}).then(function(t){return t.data})},this.Carts.saveCart=function(e){return t.post("/api/carts/cart.php",e).then(function(t){return t.data})},this.Fishbowl={},this.Fishbowl.getLog=function(){return t.get("/api/fishbowl/fishbowl_log.php").then(function(t){return t.data})},this.Fishbowl.submitLog=function(e){return t.post("/api/fishbowl/fishbowl_log.php",e)},this.Fishbowl.deleteLogItem=function(e){return t["delete"]("/api/fishbowl/fishbowl_log.php",{params:{fishbowl_logID:e}})},this.Fishbowl.getInfo=function(){return t.get("/api/fishbowl/app.php").then(function(t){return t.data.deadline*=1e3,t.data})},this.Fishbowl.submitApp=function(e){return t.post("/api/fishbowl/app.php",e)},this.Fishbowl.archive=function(){return t["delete"]("/api/fishbowl/fishbowl.php")},this.Fishbowl.get=function(){return t.get("/api/fishbowl/fishbowl.php").then(function(t){return t.data})},this.Fishbowl.getApp=function(e){return t.get("/api/fishbowl/review.php",{params:{fishbowlID:e}}).then(function(t){return t.data})},this.Fishbowl.rateApps=function(e){return t.post("/api/fishbowl/review.php",e)},this.Import={},this.Import.getDirectory=function(){return t.get("/api/import/directory.php").then(function(t){return t.data})},this.Import.getAlbum=function(e,r){return t.get("/api/import/album.php",{params:{artist_name:e,album_name:r}}).then(function(t){return t.data})},this.Import.getCart=function(e){return t.get("/api/import/cart.php",{params:{filename:e}}).then(function(t){return t.data})},this.Import.importAlbum=function(e){return t.post("/api/import/album.php",e)},this.Import.importCart=function(e){return t.post("/api/import/cart.php",e)},this.Library={},this.Library.getLibrary=function(e,r,i,n){return t.get("/api/library/library.php",{params:{rotationID:e,general_genreID:r,query:i,page:n}}).then(function(t){return t.data})},this.Library.moveRotation=function(e){return t.post("/api/library/library.php",e)},this.Library.printLabels=function(e){return t.get("/api/library/print_labels.php",{params:{"albums[]":e}})},this.Library.getAlbum=function(e){return t.get("/api/library/album.php",{params:{albumID:e}}).then(function(t){return t.data})},this.Library.getRelatedArtists=function(r){return n=n||t.get("/api/auth/spotify.php").then(function(t){return t.data}),n.then(function(i){return t.get("https://api.spotify.com/v1/search",{cache:!0,headers:{Authorization:"Bearer "+i.access_token},params:{type:"artist",limit:1,q:r}}).then(function(r){var n=r.data.artists.items[0];return n?t.get("https://api.spotify.com/v1/artists/"+n.id+"/related-artists",{cache:!0,headers:{Authorization:"Bearer "+i.access_token}}):e.resolve({artists:[]})}).then(function(t){return t.data.artists.map(function(t){return t.name})},function(){return[]})})},this.Library.saveAlbum=function(e){return t.post("/api/library/album.php",e)},this.Library.checkoutAlbum=function(e){return t.post("/api/library/checkout.php",null,{params:{albumID:e}})},this.Library.returnAlbum=function(e){return t["delete"]("/api/library/checkout.php",{params:{albumID:e}})},this.Library.reviewAlbum=function(e){return t.post("/api/library/review.php",e)},this.Library.deleteAlbum=function(e){return t["delete"]("/api/library/album.php",{params:{albumID:e}})},this.Logbook={},this.Logbook.getListenerCount=function(){return t.get("/api/logbook/listener_count.php").then(function(t){return t.data})},this.Logbook.getCurrentShow=function(){return i.LogbookShow.get().$promise},this.Logbook.signOn=function(t){return i.LogbookShow.save({scheduleID:t},null).$promise},this.Logbook.signOff=function(){return i.LogbookShow.remove().$promise},this.Logbook.getAlbum=function(t){return i.LogbookTrack.get({album_code:t}).$promise},this.Logbook.getTrack=function(t,e,r){return i.LogbookTrack.get({album_code:t,disc_num:e,track_num:r}).$promise},this.Logbook.logTrack=function(t){return i.LogbookTrack.save({},t).$promise},this.Playlist={},this.Playlist.getPlaylists=function(){return t.get("/api/playlist/playlists.php").then(function(t){return t.data})},this.Playlist.get=function(t){return i.Playlist.get({playlistID:t})},this.Playlist.getAlbum=function(t){return i.PlaylistTrack.get({album_code:t}).$promise},this.Playlist.getTrack=function(t,e,r){return i.PlaylistTrack.get({album_code:t,disc_num:e,track_num:r}).$promise},this.Playlist.save=function(t){return i.Playlist.save({},t).$promise},this.Playlist["delete"]=function(t){return i.Playlist.remove({playlistID:t}).$promise},this.Schedule={},this.Schedule.get=function(e){return t.get("/api/schedule/schedule.php",{params:{day:e}}).then(function(t){return t.data})},this.Schedule.clear=function(){return t["delete"]("/api/schedule/schedule.php")},this.Schedule.getShow=function(t){return i.Show.get({scheduleID:t})},this.Schedule.saveShow=function(t){return i.Show.save({},t).$promise},this.Schedule.removeShow=function(t){return i.Show.remove({scheduleID:t}).$promise},this.Show={},this.Show.getArchives=function(e,r){return t.get("/api/shows/archives.php",{params:{page:e,term:r}}).then(function(t){return t.data})},this.ShowSub={},this.ShowSub.getSubRequests=function(){return t.get("/api/showsub/request_list.php").then(function(t){return t.data})},this.ShowSub.submitSubRequest=function(t){return i.ShowSub.save({},t).$promise},this.ShowSub.fillSubRequest=function(t){return i.ShowSub.fill({requestID:t},null).$promise},this.ShowSub.removeSubRequest=function(t){return i.ShowSub.remove({requestID:t}).$promise},this.Staff={},this.Staff.get=function(){return t.get("/api/staff/staff.php").then(function(t){return t.data})},this.Staff.addMember=function(e){return t.post("/api/staff/staff.php",e)},this.Staff.removeMember=function(e){return t["delete"]("/api/staff/staff.php",{params:{positionID:e}})},this.Users={},this.Users.getAlbumReviewChart=function(e,r){return t.get("/api/users/reviews.php",{params:{date1:e/1e3,date2:r/1e3}}).then(function(t){return t.data})},this.Users.getUsers=function(e){var r=e?"/api/users/users_admin.php":"/api/users/users.php";return t.get(r).then(function(t){return t.data})},this.Users.saveUser=function(e){return t.post("/api/users/users_admin.php",e)},this.Users.search=function(e){return t.get("/api/users/search.php",{params:{term:e}}).then(function(t){return t.data})},this.User={},this.User.get=function(){return t.get("/api/users/user.php").then(function(t){return t.data})},this.User.save=function(e){return t.post("/api/users/user.php",e)}}]);